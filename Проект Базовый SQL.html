<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Проект: Базовый SQL</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-opaquegray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="94bd0639-e468-4e61-909b-e06c951036b5" class="page sans"><header><h1 class="page-title">Проект: Базовый SQL</h1></header><div class="page-body"><hr id="fa129063-4012-4904-a5fd-b8275066afac"/><p id="cb04dd90-868c-45fa-a1f2-0f26c139fe61" class=""><strong>Задача проекта:</strong> нужно проанализировать данные о фондах и инвестициях и написать запросы к базе.</p><p id="3ee09fc9-f149-4283-bb39-78239c747e9a" class=""><strong>Схема базы данных:</strong></p><figure id="e53c2fdb-c3f1-4857-9d16-2275598a4192" class="image"><a href="%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%20%D0%91%D0%B0%D0%B7%D0%BE%D0%B2%D1%8B%D0%B8%CC%86%20SQL%2094bd0639e4684e61909be06c951036b5/Untitled.png"><img style="width:8000px" src="%D0%9F%D1%80%D0%BE%D0%B5%D0%BA%D1%82%20%D0%91%D0%B0%D0%B7%D0%BE%D0%B2%D1%8B%D0%B8%CC%86%20SQL%2094bd0639e4684e61909be06c951036b5/Untitled.png"/></a></figure><p id="892fd751-bcce-4999-abd4-47c11260b184" class="">
</p><p id="d6c56a5c-28e8-435d-ad9a-0c02adc8bcb8" class=""><strong>Описание базы данных:</strong></p><p id="72123aac-7001-4274-8ed4-dc58433c5225" class="">
</p><p id="9ea16052-d4f4-415a-810f-d470984dd5ea" class="block-color-teal_background">acquisition</p><p id="1e710ecc-6cd4-4174-bc61-612984f27fde" class="">Содержит информацию о покупках одних компаний другими.</p><p id="8c34b0c8-b057-4ebd-8bb6-dc22e5067cb8" class="">Таблица включает такие поля:</p><ul id="96a44066-3ed2-461c-87f4-4be1f9b7ca96" class="bulleted-list"><li style="list-style-type:disc">первичный ключ <code>id</code> — идентификатор или уникальный номер покупки;</li></ul><ul id="f77d0ace-6052-470f-83f2-859dc30ec8e3" class="bulleted-list"><li style="list-style-type:disc">внешний ключ <code>acquiring_company_id</code> — ссылается на таблицу <code>company</code> — идентификатор компании-покупателя, то есть той, что покупает другую компанию;</li></ul><ul id="6b074337-1433-4016-ac4c-92762f0786ad" class="bulleted-list"><li style="list-style-type:disc">внешний ключ <code>acquired_company_id</code> — ссылается на таблицу <code>company</code> — идентификатор компании, которую покупают;</li></ul><ul id="a37c6cbe-7053-48bf-aedf-fe791e2972b1" class="bulleted-list"><li style="list-style-type:disc"><code>term_code</code> — способ оплаты сделки:<ul id="9c9eea3e-b8cb-44fa-85a4-5b0169df4b31" class="bulleted-list"><li style="list-style-type:circle"><code>cash</code> — наличными;</li></ul><ul id="1cf26945-7450-4208-8635-3458b585242a" class="bulleted-list"><li style="list-style-type:circle"><code>stock</code> — акциями компании;</li></ul><ul id="89ce853d-66c7-4ca7-be17-ebfe2bd8a7a1" class="bulleted-list"><li style="list-style-type:circle"><code>cash_and_stock</code> — смешанный тип оплаты: наличные и акции.</li></ul></li></ul><ul id="4392c046-a9f0-468d-a558-a691f3773459" class="bulleted-list"><li style="list-style-type:disc"><code>price_amount</code> — сумма покупки в долларах;</li></ul><ul id="44efa562-0df7-4238-aaa8-f863d836b94b" class="bulleted-list"><li style="list-style-type:disc"><code>acquired_at</code> — дата совершения сделки;</li></ul><ul id="09365313-7994-4e0b-a57f-50905bea19de" class="bulleted-list"><li style="list-style-type:disc"><code>created_at</code> — дата и время создания записи в таблице;</li></ul><ul id="1025b67f-c195-4f4b-8daf-9a248184c510" class="bulleted-list"><li style="list-style-type:disc"><code>updated_at</code> — дата и время обновления записи в таблице.</li></ul><p id="5dbfce6f-8185-4245-9bee-ea7687e2f3a6" class="">
</p><p id="8292865e-c964-430b-aa14-6de24505f299" class="block-color-teal_background">company</p><p id="b667ece6-9f0a-4e56-8e57-a02c8056b3db" class="">Содержит информацию о компаниях-стартапах.</p><ul id="8dca43a9-e800-40b9-b326-cf60e5b8f486" class="bulleted-list"><li style="list-style-type:disc">первичный ключ <code>id</code> — идентификатор, или уникальный номер компании;</li></ul><ul id="c3f2c99e-d3ea-4796-a4f9-467f220addae" class="bulleted-list"><li style="list-style-type:disc"><code>name</code> — название компании;</li></ul><ul id="743290ee-dba6-4352-aa30-65bd27c37218" class="bulleted-list"><li style="list-style-type:disc"><code>category_code</code> — категория деятельности компании, например:<ul id="d7a6555c-e07a-4451-bd51-63fc9def19ab" class="bulleted-list"><li style="list-style-type:circle"><code>news</code> — специализируется на работе с новостями;</li></ul><ul id="92bf45fc-cb10-48d5-9bdc-1eaa934a3a6c" class="bulleted-list"><li style="list-style-type:circle"><code>social</code> — специализируется на социальной работе.</li></ul></li></ul><ul id="ccabc215-7e53-4df2-bba6-4235dc6ba4ec" class="bulleted-list"><li style="list-style-type:disc"><code>status</code> — статус компании:<ul id="244227be-f6a6-443c-98c0-4cf8b117b3ae" class="bulleted-list"><li style="list-style-type:circle"><code>acquired</code> — приобретена;</li></ul><ul id="0d1a705a-5016-4364-81fc-ebcb59372619" class="bulleted-list"><li style="list-style-type:circle"><code>operating</code> — действует;</li></ul><ul id="33df0c5e-38ba-4108-a868-dff187a1a45d" class="bulleted-list"><li style="list-style-type:circle"><code>ipo</code> — вышла на IPO;</li></ul><ul id="77366bda-fc33-4730-9014-31aadff99075" class="bulleted-list"><li style="list-style-type:circle"><code>closed</code> — перестала существовать.</li></ul></li></ul><ul id="271305bb-3275-4e17-bc56-50756371d2e6" class="bulleted-list"><li style="list-style-type:disc"><code>founded_at</code> — дата основания компании;</li></ul><ul id="02ebd5ef-0c7a-434a-88e0-3e8aa5512413" class="bulleted-list"><li style="list-style-type:disc"><code>closed_at</code> — дата закрытия компании, которую указывают в том случае, если компании больше не существует;</li></ul><ul id="db598d19-87b2-4c00-93b5-025910c47e44" class="bulleted-list"><li style="list-style-type:disc"><code>domain</code> — домен сайта компании;</li></ul><ul id="579d25f5-e01b-4d99-bbd5-5bbc4632f607" class="bulleted-list"><li style="list-style-type:disc"><code>twitter_username</code> — название профиля компании в твиттере;</li></ul><ul id="c4ec09d4-337d-40a2-b89d-fdb7d0cb2767" class="bulleted-list"><li style="list-style-type:disc"><code>country_code</code> — код страны, например, <code>USA</code> для США, <code>GBR</code> для Великобритании;</li></ul><ul id="22c5a83d-527f-43d1-bf7e-25c15ca1513e" class="bulleted-list"><li style="list-style-type:disc"><code>investment_rounds</code> — число раундов, в которых компания участвовала как инвестор;</li></ul><ul id="fbdfd296-8608-47c3-b084-f022b44f418f" class="bulleted-list"><li style="list-style-type:disc"><code>funding_rounds</code> — число раундов, в которых компания привлекала инвестиции;</li></ul><ul id="35605e7a-5c13-4657-afda-a6662247fb61" class="bulleted-list"><li style="list-style-type:disc"><code>funding_total</code> — сумма привлечённых инвестиций в долларах;</li></ul><ul id="21e3dfd6-1eef-4293-888a-1c358c301b8f" class="bulleted-list"><li style="list-style-type:disc"><code>milestones</code> — количество важных этапов в истории компании;</li></ul><ul id="677328f1-5a55-4b99-b23c-216d99ac307b" class="bulleted-list"><li style="list-style-type:disc"><code>created_at</code> — дата и время создания записи в таблице;</li></ul><ul id="074061b9-c87a-4597-81fb-e6ad07ffa440" class="bulleted-list"><li style="list-style-type:disc"><code>updated_at</code> — дата и время обновления записи в таблице.</li></ul><p id="f0fdb5d2-d831-4e9e-9bad-dcb118126d07" class="">
</p><p id="29c7a952-a0e1-4af8-a95b-194e727c1642" class="block-color-teal_background">education</p><p id="d5838cb1-2e96-422e-80b9-9f57b08c42f9" class="">Хранит информацию об уровне образования сотрудников компаний.</p><ul id="35b5bcaa-f8fc-48d4-8889-b6c4bb05c0de" class="bulleted-list"><li style="list-style-type:disc">первичный ключ <code>id</code> — уникальный номер записи с информацией об образовании;</li></ul><ul id="62d73e3f-6f87-424d-b0a3-3f2d9413bde0" class="bulleted-list"><li style="list-style-type:disc">внешний ключ <code>person_id</code> — ссылается на таблицу <code>people</code> — идентификатор человека, информация о котором представлена в записи;</li></ul><ul id="a9437f47-2c4e-4505-bd81-59eb79f27c71" class="bulleted-list"><li style="list-style-type:disc"><code>degree_type</code> — учебная степень, например:<ul id="e239a8a9-00b2-4046-9483-389e386ba3d4" class="bulleted-list"><li style="list-style-type:circle"><code>BA</code> — Bachelor of Arts — бакалавр гуманитарных наук;</li></ul><ul id="589b81aa-b274-490a-b1e7-2a929eeb8534" class="bulleted-list"><li style="list-style-type:circle"><code>MS</code> — Master of Science — магистр естественных наук.</li></ul></li></ul><ul id="0cbf9cd5-151f-47c3-a54b-db9689dc0555" class="bulleted-list"><li style="list-style-type:disc"><code>instituition</code> — учебное заведение, название университета;</li></ul><ul id="1f0e9f51-90ef-4096-aefc-0dd077e274b2" class="bulleted-list"><li style="list-style-type:disc"><code>graduated_at</code> — дата завершения обучения, выпуска;</li></ul><ul id="6504de32-5f2b-4744-a326-06c38164c71f" class="bulleted-list"><li style="list-style-type:disc"><code>created_at</code> — дата и время создания записи в таблице;</li></ul><ul id="e5556544-79d1-4bcd-87d3-36f9a29ae836" class="bulleted-list"><li style="list-style-type:disc"><code>updated_at</code> — дата и время обновления записи в таблице.</li></ul><p id="8cbd97d5-437b-42c1-814c-96fafac5b34d" class="">
</p><p id="fe0c40e4-fe9a-4b5a-ac44-aaa8786444fd" class="block-color-teal_background">fund</p><p id="6efc6267-b153-48e2-b56d-2ffec187b3d4" class="">Хранит информацию о венчурных фондах.</p><ul id="d1eed5b9-0e85-4952-bfde-30eb453f1a67" class="bulleted-list"><li style="list-style-type:disc">первичный ключ <code>id</code> — уникальный номер венчурного фонда;</li></ul><ul id="f15ff3ac-09b8-4c56-a67d-38e685d0b01b" class="bulleted-list"><li style="list-style-type:disc"><code>name</code> — название венчурного фонда;</li></ul><ul id="de256926-7438-4d69-b121-adf2e96f8aac" class="bulleted-list"><li style="list-style-type:disc"><code>founded_at</code> — дата основания фонда;</li></ul><ul id="31c7933f-15c0-43ba-971e-15c5174594f9" class="bulleted-list"><li style="list-style-type:disc"><code>domain</code> — домен сайта фонда;</li></ul><ul id="ebe71e87-acd6-4573-a326-cf3b6a5a2986" class="bulleted-list"><li style="list-style-type:disc"><code>twitter_username</code> — профиль фонда в твиттере;</li></ul><ul id="de22eeda-068c-495d-99d8-413ea72f4bda" class="bulleted-list"><li style="list-style-type:disc"><code>country_code</code> — код страны фонда;</li></ul><ul id="28866af1-79fb-4272-9a13-818e3418c12b" class="bulleted-list"><li style="list-style-type:disc"><code>investment_rounds</code> — число инвестиционных раундов, в которых фонд принимал участие;</li></ul><ul id="f3973a87-ef95-4e82-880d-3f6646216d4c" class="bulleted-list"><li style="list-style-type:disc"><code>invested_companies</code> — число компаний, в которые инвестировал фонд;</li></ul><ul id="6cb3a145-8ede-48ee-baac-1db08bf5a5e7" class="bulleted-list"><li style="list-style-type:disc"><code>milestones</code> — количество важных этапов в истории фонда;</li></ul><ul id="6b928d7d-670e-4842-95f1-0b32fb7b0ae8" class="bulleted-list"><li style="list-style-type:disc"><code>created_at</code> — дата и время создания записи в таблице;</li></ul><ul id="b331f7aa-62bf-4364-a9b9-5e2fd1a5a25f" class="bulleted-list"><li style="list-style-type:disc"><code>updated_at</code> — дата и время обновления записи в таблице.</li></ul><p id="c5ab3fc4-752f-4ac2-89ea-410a1865eee7" class="">
</p><p id="57881791-bc37-47e9-8f01-42642424d00a" class="block-color-teal_background"><mark class="highlight-teal_background">funding_round</mark></p><p id="17da795d-6b85-4abc-9fa9-52a3ffb0e59b" class="">Содержит информацию о раундах инвестиций.</p><ul id="ac63907d-002b-43e9-96b3-87e361cb953e" class="bulleted-list"><li style="list-style-type:disc">первичный ключ <code>id</code> — уникальный номер инвестиционного раунда;</li></ul><ul id="09f29c9a-c2ea-496a-9b9d-615ce6d5bc6e" class="bulleted-list"><li style="list-style-type:disc">внешний ключ <code>company_id</code> — ссылается на таблицу <code>company</code> — уникальный номер компании, участвовавшей в инвестиционном раунде;</li></ul><ul id="9c041ae6-8ddb-4239-9bba-a0cfa0d0c653" class="bulleted-list"><li style="list-style-type:disc"><code>funded_at</code> — дата проведения раунда;</li></ul><ul id="85396aac-b1e5-4c6b-9fe2-1405ab78e7fc" class="bulleted-list"><li style="list-style-type:disc"><code>funding_round_type</code> — тип инвестиционного раунда, например:<ul id="6e9f2e57-d0b6-42df-8a03-3867c3cec36f" class="bulleted-list"><li style="list-style-type:circle"><code>venture</code> — венчурный раунд;</li></ul><ul id="86927fd4-e3f3-4451-93de-cd6091b174e6" class="bulleted-list"><li style="list-style-type:circle"><code>angel</code> — ангельский раунд;</li></ul><ul id="ad3f23a1-c906-41e4-8bd1-edba5316aec3" class="bulleted-list"><li style="list-style-type:circle"><code>series_a</code> — раунд А.</li></ul></li></ul><ul id="e20c471b-e8cb-4dae-9a5d-d9806395fa6f" class="bulleted-list"><li style="list-style-type:disc"><code>raised_amount</code> — сумма инвестиций, которую привлекла компания в этом раунде в долларах;</li></ul><ul id="5edee887-fea3-4721-8ec1-7dcd7518b786" class="bulleted-list"><li style="list-style-type:disc"><code>pre_money_valuation</code> — предварительная, проведённая до инвестиций оценка стоимости компании в долларах;</li></ul><ul id="8d515b54-02ec-47cd-8b06-a38ce86a7bfb" class="bulleted-list"><li style="list-style-type:disc"><code>participants</code> — количество участников инвестиционного раунда;</li></ul><ul id="c047afff-bf4c-4dd6-982e-a5983417ab63" class="bulleted-list"><li style="list-style-type:disc"><code>is_first_round</code> — является ли этот раунд первым для компании;</li></ul><ul id="11ef91de-d831-402b-b8e2-2b4c3b4cb56d" class="bulleted-list"><li style="list-style-type:disc"><code>is_last_round</code> — является ли этот раунд последним для компании;</li></ul><ul id="66b95930-fdc1-478b-b225-d4a34c9d0154" class="bulleted-list"><li style="list-style-type:disc"><code>created_at</code> — дата и время создания записи в таблице;</li></ul><ul id="19062349-e313-4b4b-877f-243b9575f594" class="bulleted-list"><li style="list-style-type:disc"><code>updated_at</code> — дата и время обновления записи в таблице.</li></ul><p id="718a2b09-8a14-4e79-b451-ac62b5e25e0b" class="">
</p><p id="689001b9-d03e-4a14-a837-9c05c6ede3b8" class="block-color-teal_background">investment</p><p id="8c6b5303-4453-426a-a844-49fa8ccf8e01" class="">Содержит информацию об инвестициях венчурных фондов в компании-стартапы.</p><ul id="32e2e166-bdc0-4884-99c8-98c02d8c7046" class="bulleted-list"><li style="list-style-type:disc">первичный ключ <code>id</code> — уникальный номер инвестиции;</li></ul><ul id="8ac2d3c7-733a-468a-b76b-44846f6837f2" class="bulleted-list"><li style="list-style-type:disc">внешний ключ <code>funding_round_id</code> — ссылается на таблицу <code>funding_round</code> — уникальный номер раунда инвестиции;</li></ul><ul id="710064d5-e48b-4f56-a383-e8fb3019b47d" class="bulleted-list"><li style="list-style-type:disc">внешний ключ <code>company_id</code> — ссылается на таблицу <code>company</code> — уникальный номер компании-стартапа, в которую инвестируют;</li></ul><ul id="0471df6a-1e94-4b56-9352-a353825f3187" class="bulleted-list"><li style="list-style-type:disc">внешний ключ <code>fund_id</code> — ссылается на таблицу <code>fund</code> — уникальный номер фонда, инвестирующего в компанию-стартап;</li></ul><ul id="376ee617-9bcb-4bc3-a6cb-4a65ee61027b" class="bulleted-list"><li style="list-style-type:disc"><code>created_at</code> — дата и время создания записи в таблице;</li></ul><ul id="be2f4aad-bdeb-4185-a351-c0201790c0a0" class="bulleted-list"><li style="list-style-type:disc"><code>updated_at</code> — дата и время обновления записи в таблице.</li></ul><p id="85bc915f-fe7a-40ec-933e-d35716c11b9d" class="">
</p><p id="a55cdd91-3d04-4216-8b87-668e7cbf8887" class="block-color-teal_background">people</p><p id="f3a6ff8f-1f96-4987-ad99-992e93065073" class="">Содержит информацию о сотрудниках компаний-стартапов.</p><ul id="da8c495f-18b3-4253-8a9f-0f6b992d089b" class="bulleted-list"><li style="list-style-type:disc">первичный ключ <code>id</code> — уникальный номер сотрудника;</li></ul><ul id="23bc1d90-b2c3-496b-9c8e-12af56d88c87" class="bulleted-list"><li style="list-style-type:disc"><code>first_name</code> — имя сотрудника;</li></ul><ul id="ab832f56-18eb-4386-8b46-4194c05ccce3" class="bulleted-list"><li style="list-style-type:disc"><code>last_name</code> — фамилия сотрудника;</li></ul><ul id="7bd04121-a79f-4869-8c89-8e16625a8581" class="bulleted-list"><li style="list-style-type:disc">внешний ключ <code>company_id</code> — ссылается на таблицу <code>company</code> — уникальный номер компании-стартапа;</li></ul><ul id="422360c5-b505-444e-b90e-365f53eeaf80" class="bulleted-list"><li style="list-style-type:disc"><code>twitter_username</code> — профиль сотрудника в твиттере;</li></ul><ul id="cb70a978-f560-4f39-a950-1c3d9b287e7b" class="bulleted-list"><li style="list-style-type:disc"><code>created_at</code> — дата и время создания записи в таблице;</li></ul><ul id="28a94be7-8dc2-4b74-8b78-6cc557e69307" class="bulleted-list"><li style="list-style-type:disc"><code>updated_at</code> — дата и время обновления записи в таблице.</li></ul><p id="9ae0e9c7-0682-46fa-ae76-d85e78b139eb" class="">
</p><p id="99b7c870-be62-4761-b57e-81c0fa0bfb1f" class=""><strong>Задания:</strong></p><ol type="1" id="54695567-7079-4fcb-b7cd-2babc9a8d420" class="numbered-list" start="1"><li>Посчитайте, сколько компаний закрылось.</li></ol><p id="ea820298-bae0-4682-9503-f5f33a64eee9" class="">
</p><p id="aaa9a559-685c-4c1f-ad76-c3ab5b995995" class="block-color-gray_background">SELECT COUNT(status)
FROM company
WHERE status = &#x27;closed&#x27;</p><p id="a9b32af4-6630-450d-a0b4-874eb8984418" class="">count</p><hr id="d3f0c9e0-39bc-4045-8a20-10aad84e3c1e"/><p id="87ed1e1b-e857-4258-a317-37bb2e27b01a" class="">2584</p><hr id="8b7e38c0-0576-4e1c-847c-c1fe181f458f"/><p id="ca8206fa-1883-434a-93d1-eff942d3d7c5" class="">
</p><ol type="1" id="ccb13d3f-6833-4ab5-b264-512ea220ef51" class="numbered-list" start="2"><li>Отобразите количество привлечённых средств для новостных компаний США. Используйте данные из таблицы <code>company</code>. Отсортируйте таблицу по убыванию значений в поле <code>funding_total</code>.</li></ol><p id="8f51eb4b-d5ce-4356-9103-194d63e98c28" class="">
</p><p id="5bcbf068-53ea-4f68-8de3-0c1588be3561" class="block-color-gray_background">SELECT funding_total
FROM company
WHERE country_code = &#x27;USA&#x27; AND category_code = &#x27;news&#x27;
ORDER BY funding_total DESC;</p><p id="45d2fb74-fd80-419e-9a3a-b4b71233152e" class="">funding_total</p><hr id="7ecbaf91-92cf-4fad-bc22-3ac6e4f98e48"/><p id="572c9e92-ed5e-428e-9c61-8624755fa4e1" class="">6.22553e+08</p><hr id="93150d1f-3d56-4f7f-bbec-fb433d30fe8c"/><p id="b876aa86-6c09-4f9a-af7a-3a52ee4513d7" class="">2.5e+08</p><hr id="2e06b35d-fa86-4f86-8c6a-807bfc323240"/><p id="afedcbc5-c208-4076-8023-fe8ce1dfc3f0" class="">1.605e+08</p><hr id="712a9699-7b9d-4987-8cb1-9a2fb4670291"/><p id="e2f17d4b-9266-42ab-b724-c180704a98a9" class="">1.28e+08</p><hr id="750d2b3b-cf7f-47ce-8922-f0fa8fa99e69"/><p id="2b0992f5-ac08-4d5f-b37a-f57770b93ec1" class="">…</p><hr id="89dc8fa9-52ec-48a9-be0f-7cb2b96f1d88"/><p id="95905883-21d5-4a00-8d40-d8e6cb7b88b6" class="">
</p><ol type="1" id="c2528914-4a0f-4f1d-8808-f5bc24c20721" class="numbered-list" start="3"><li>Найдите общую сумму сделок по покупке одних компаний другими в долларах. Отберите сделки, которые осуществлялись только за наличные с 2011 по 2013 год включительно.</li></ol><p id="e6e71a83-12ae-47aa-9220-ef59e8cbb2a1" class="">
</p><p id="50b006d5-9dad-4532-b4bd-2beea256c937" class="block-color-gray_background">SELECT SUM(price_amount)
FROM acquisition
WHERE term_code=&#x27;cash&#x27; AND (EXTRACT(YEAR FROM CAST(acquired_at AS date)) BETWEEN 2011 AND 2013)</p><p id="2b170239-40ef-4fbb-a525-d03cce25e107" class="">sum</p><hr id="0d6c46e5-5b19-4ef1-b2f8-ce54f07e6927"/><p id="ac785a12-1965-4e15-9c00-0fbfb3df68ce" class="">1.37762e+11</p><hr id="b7282e5d-93f1-437a-b277-793c8b7a2e86"/><p id="c7c8129a-6c83-462a-b6b3-fea8bbda971a" class="">
</p><ol type="1" id="86783c3c-85df-45aa-babf-0deefe8b1d47" class="numbered-list" start="4"><li>Отобразите имя, фамилию и названия аккаунтов людей в твиттере, у которых названия аккаунтов начинаются на <code>&#x27;Silver&#x27;</code>.</li></ol><p id="8ef5c213-e092-48fc-8c0f-8de569a19499" class="">
</p><p id="555e39e9-c03b-4a07-aa88-e8107f1d680d" class="block-color-gray_background">SELECT first_name,
last_name,
twitter_username
FROM people
WHERE twitter_username LIKE &#x27;Silver%&#x27;</p><table id="b4b93378-8688-49f1-a959-50f575170564" class="simple-table"><tbody><tr id="59ea0742-3804-4338-96c9-607b36cd6bc8"><td id="bINT" class="">first_name</td><td id="QW{c" class="">last_name</td><td id="ZVpZ" class="">twitter_username</td></tr><tr id="5d92275b-91b4-4c62-b585-343c67d88f4d"><td id="bINT" class="">Rebecca</td><td id="QW{c" class="">Silver</td><td id="ZVpZ" class="">SilverRebecca</td></tr><tr id="1b95f3d2-2137-4088-a658-cea6ecd09ecf"><td id="bINT" class="">Silver</td><td id="QW{c" class="">Teede</td><td id="ZVpZ" class="">SilverMatrixx</td></tr><tr id="2d2b319b-fb01-41c1-ae4d-08c8b886d7d5"><td id="bINT" class="">Mattias</td><td id="QW{c" class="">Guilotte</td><td id="ZVpZ" class="">Silverreven</td></tr></tbody></table><p id="84fa5392-ef1e-402c-a0a7-3734a38bfbf8" class="">
</p><ol type="1" id="343b66f2-52a7-4643-bb30-c72a6aaa777e" class="numbered-list" start="5"><li>Выведите на экран всю информацию о людях, у которых названия аккаунтов в твиттере содержат подстроку <code>&#x27;money&#x27;</code>, а фамилия начинается на <code>&#x27;K&#x27;</code>.</li></ol><p id="0cac4e58-6184-4e26-bc35-4c3ae7a6144c" class="">
</p><p id="44264306-ed82-42be-8513-50c7ac5df48f" class="block-color-gray_background">SELECT *
FROM people
WHERE twitter_username LIKE &#x27;%money%&#x27; AND last_name LIKE &#x27;K%&#x27;</p><table id="4776ef65-f4b3-4896-addd-00da235040da" class="simple-table"><tbody><tr id="52386859-1549-46f3-b53e-f9b915a808f1"><td id="[OXc" class="">id</td><td id="VXaX" class="">first_name</td><td id="S;_n" class="">last_name</td><td id="^n?Z" class="">company_id</td><td id=":lVe" class="">twitter_username</td><td id="}Hf_" class="">created_at</td><td id="NUEg" class="">updated_at</td></tr><tr id="29a2204c-1a73-4722-9848-824611ca5cf4"><td id="[OXc" class="">63081</td><td id="VXaX" class="">Gregory</td><td id="S;_n" class="">Kim</td><td id="^n?Z" class=""></td><td id=":lVe" class="">gmoney75</td><td id="}Hf_" class="">2010-07-13 03:46:28</td><td id="NUEg" class="">2011-12-12 22:01:34</td></tr></tbody></table><p id="b520086d-2e6d-4948-bc4e-45558fa8ee81" class="">
</p><ol type="1" id="bebea879-4d8d-4b21-bea2-0a778f1baacd" class="numbered-list" start="6"><li>Для каждой страны отобразите общую сумму привлечённых инвестиций, которые получили компании, зарегистрированные в этой стране. Страну, в которой зарегистрирована компания, можно определить по коду страны. Отсортируйте данные по убыванию суммы.</li></ol><p id="42cbd319-f172-4f22-815e-64979cdab8ac" class="">
</p><p id="77d4f90b-ad2a-4380-a16c-980176783847" class="block-color-gray_background">SELECT country_code,
SUM(funding_total)
FROM company
GROUP BY country_code
ORDER BY SUM(funding_total) DESC</p><table id="51bb95f9-6947-4592-aab1-669b04a70aa8" class="simple-table"><tbody><tr id="5a4641d1-b50f-4deb-bad9-182b2dee9082"><td id="aDlU" class="">country_code</td><td id="T[E:" class="">sum</td></tr><tr id="29cf2b7f-bd32-4150-82b2-7d153fb972e7"><td id="aDlU" class="">USA</td><td id="T[E:" class="">3.10588e+11</td></tr><tr id="aad3dcf0-b6a8-4fe4-8ae4-b779516b4ddf"><td id="aDlU" class="">GBR</td><td id="T[E:" class="">1.77056e+10</td></tr><tr id="3ba56abb-b264-48fe-8aa4-618e22234007"><td id="aDlU" class="">CHN</td><td id="T[E:" class="">1.06897e+10</td></tr><tr id="f12257b9-b314-43d7-a3aa-87978912bf55"><td id="aDlU" class="">CAN</td><td id="T[E:" class="">9.86636e+09</td></tr><tr id="b3f20224-a58e-43e9-bd3a-c6d33c8aa5c7"><td id="aDlU" class="">IND</td><td id="T[E:" class="">6.14141e+09</td></tr><tr id="86288f2d-ae20-456e-b5e8-d792504149f9"><td id="aDlU" class="">…</td><td id="T[E:" class="">…</td></tr></tbody></table><ol type="1" id="26d95a36-173e-42f2-973d-0d6c8098e76b" class="numbered-list" start="7"><li>Составьте таблицу, в которую войдёт дата проведения раунда, а также минимальное и максимальное значения суммы инвестиций, привлечённых в эту дату.
Оставьте в итоговой таблице только те записи, в которых минимальное значение суммы инвестиций не равно нулю и не равно максимальному значению.</li></ol><p id="41138433-a5d7-46b9-837f-2f066594af29" class="">
</p><p id="fd519960-2a64-4a0d-958b-e4aac2cfe075" class="block-color-gray_background">SELECT funded_at,
MIN(raised_amount),
MAX(raised_amount)
FROM funding_round
GROUP BY funded_at
HAVING MIN(raised_amount) != 0 AND MAX(raised_amount)!= MIN(raised_amount)</p><table id="39248805-05b2-4665-bcfa-5e4f25edb776" class="simple-table"><tbody><tr id="dc4d4c81-9e5e-473c-98a5-924e92f78322"><td id="gE]:" class="">funded_at</td><td id="WeRY" class="">min</td><td id="XuUm" class="">max</td></tr><tr id="161a8ba5-6ec5-46c9-a442-27c438b74dfb"><td id="gE]:" class="">2012-08-22</td><td id="WeRY" class="">40000</td><td id="XuUm" class="">7.5e+07</td></tr><tr id="130d9f1f-b39a-48d9-9844-cd75cef911fb"><td id="gE]:" class="">2010-07-25</td><td id="WeRY" class="">3.27825e+06</td><td id="XuUm" class="">9e+06</td></tr><tr id="7b3fff8d-4d32-4d23-b87d-0839caf4289c"><td id="gE]:" class="">2002-03-01</td><td id="WeRY" class="">2.84418e+06</td><td id="XuUm" class="">8.95915e+06</td></tr><tr id="f80ffd9d-a948-4c42-8e4d-8d9ae5e4f957"><td id="gE]:" class="">…</td><td id="WeRY" class="">…</td><td id="XuUm" class="">…</td></tr></tbody></table><ol type="1" id="09bec29c-d725-4719-b2c8-64c3dd857c6e" class="numbered-list" start="8"><li>Создайте поле с категориями:</li></ol><ul id="16e8e797-b04d-4380-a971-6c25dd0e6da7" class="bulleted-list"><li style="list-style-type:disc">Для фондов, которые инвестируют в 100 и более компаний, назначьте категорию <code>high_activity</code>.</li></ul><ul id="988e2398-793c-4cb5-bd50-9ae5d67ec2ba" class="bulleted-list"><li style="list-style-type:disc">Для фондов, которые инвестируют в 20 и более компаний до 100, назначьте категорию <code>middle_activity</code>.</li></ul><ul id="ea9b9732-a02c-4314-940e-f1cafd78105a" class="bulleted-list"><li style="list-style-type:disc">Если количество инвестируемых компаний фонда не достигает 20, назначьте категорию <code>low_activity</code>.</li></ul><p id="6e5e665e-6a2b-434b-b1a6-d7ee98890faa" class="">Отобразите все поля таблицы <code>fund</code> и новое поле с категориями.</p><p id="ff5049d8-e070-4735-9486-f0315f0e9c8f" class="">
</p><p id="87c23f9a-04ba-49dc-a159-533751b243ff" class="block-color-gray_background">SELECT *,
    CASE
        WHEN invested_companies &gt;= 100 THEN &#x27;high_activity&#x27;
        WHEN invested_companies &gt;= 20 AND invested_companies &lt; 100 THEN &#x27;middle_activity&#x27;
        WHEN invested_companies &lt; 20 THEN &#x27;low_activity&#x27;
    END
FROM fund</p><table id="a3e5df06-6131-477d-b9e0-53b65e4714ff" class="simple-table"><tbody><tr id="9a4de6fb-d56e-4de5-a4b6-2d548356d6b9"><td id="JHw}" class="">id</td><td id="k{QA" class="">name</td><td id="&lt;]he" class="">founded_at</td><td id="RR`V" class="">domain</td><td id="Ssj{" class="">twitter_username</td><td id="fRIb" class="">country_code</td><td id="@eZ|" class="">investment_rounds</td><td id="IZzc" class="">invested_companies</td><td id="IKit" class="">milestones</td><td id="?Eym" class="">created_at</td><td id="XYeL" class="">updated_at</td><td id="KiTg" class="">case</td></tr><tr id="160adf33-5d9e-4766-971a-57a994c6f67a"><td id="JHw}" class="">1</td><td id="k{QA" class="">Greylock Partners</td><td id="&lt;]he" class="">1965-01-01</td><td id="RR`V" class="">greylock.com</td><td id="Ssj{" class="">greylockvc</td><td id="fRIb" class="">USA</td><td id="@eZ|" class="">307</td><td id="IZzc" class="">196</td><td id="IKit" class="">0</td><td id="?Eym" class="">2007-05-25 20:18:23</td><td id="XYeL" class="">2012-12-27 00:42:24</td><td id="KiTg" class="">high_activity</td></tr><tr id="33dc8df2-4087-41b3-a740-89025afd889f"><td id="JHw}" class="">10</td><td id="k{QA" class="">Mission Ventures</td><td id="&lt;]he" class="">1996-01-01</td><td id="RR`V" class="">missionventures.com</td><td id="Ssj{" class=""></td><td id="fRIb" class="">USA</td><td id="@eZ|" class="">58</td><td id="IZzc" class="">33</td><td id="IKit" class="">0</td><td id="?Eym" class="">2007-06-05 05:24:58</td><td id="XYeL" class="">2013-10-10 22:06:31</td><td id="KiTg" class="">middle_activity</td></tr><tr id="44411b55-f6d0-43a8-9846-a5e1f6fe0d64"><td id="JHw}" class="">…</td><td id="k{QA" class="">…</td><td id="&lt;]he" class="">…</td><td id="RR`V" class="">…</td><td id="Ssj{" class="">…</td><td id="fRIb" class="">…</td><td id="@eZ|" class="">…</td><td id="IZzc" class="">…</td><td id="IKit" class="">…</td><td id="?Eym" class="">…</td><td id="XYeL" class="">…</td><td id="KiTg" class="">…</td></tr></tbody></table><p id="53aae3a7-ec55-4aae-9899-34c0b408faa3" class="">
</p><ol type="1" id="2e31a131-3fe7-470a-bce3-0417fad4815f" class="numbered-list" start="9"><li>Для каждой из категорий, назначенных в предыдущем задании, посчитайте округлённое до ближайшего целого числа среднее количество инвестиционных раундов, в которых фонд принимал участие. Выведите на экран категории и среднее число инвестиционных раундов. Отсортируйте таблицу по возрастанию среднего.</li></ol><p id="4bda6413-b99d-4c43-847c-058b986a3c4d" class="">
</p><p id="dbd32284-cb04-4d87-99da-aa614dd00754" class="block-color-gray_background">SELECT ROUND(AVG(investment_rounds)),
    CASE
        WHEN invested_companies&gt;=100 THEN &#x27;high_activity&#x27;
        WHEN invested_companies&gt;=20 THEN &#x27;middle_activity&#x27;
        ELSE &#x27;low_activity&#x27;
    END AS activity
FROM fund
GROUP BY activity
ORDER BY ROUND(AVG(investment_rounds))</p><p id="a8ccbf94-798e-4c1e-85c2-61943b2d23a3" class="">
</p><table id="339c7d76-88e9-45d7-a5c6-0acdfec57310" class="simple-table"><tbody><tr id="b8d6a54b-6794-4e86-b286-0355d33e1f68"><td id="RrPw" class="">round</td><td id="vw|B" class="">activity</td></tr><tr id="60aa1cc8-c456-482a-b836-46e34eed4267"><td id="RrPw" class="">2</td><td id="vw|B" class="">low_activity</td></tr><tr id="ddd29ee8-10ad-4b27-a267-34fc559a168e"><td id="RrPw" class="">51</td><td id="vw|B" class="">middle_activity</td></tr><tr id="b2992ebb-0c39-4eaf-82e2-4db07d3e6a15"><td id="RrPw" class="">252</td><td id="vw|B" class="">high_activity</td></tr></tbody></table><ol type="1" id="7e6e2df7-1d90-4d4b-a7ae-0b06de1ef58f" class="numbered-list" start="10"><li>Проанализируйте, в каких странах находятся фонды, которые чаще всего инвестируют в стартапы.
Для каждой страны посчитайте минимальное, максимальное и среднее число компаний, в которые инвестировали фонды этой страны, основанные с 2010 по 2012 год включительно. Исключите страны с фондами, у которых минимальное число компаний, получивших инвестиции, равно нулю.
Выгрузите десять самых активных стран-инвесторов: отсортируйте таблицу по среднему количеству компаний от большего к меньшему. Затем добавьте сортировку по коду страны в лексикографическом порядке.</li></ol><p id="0c363481-f699-4838-8d1e-b26ff79dd4c8" class="">
</p><p id="7a4032fa-8418-4fb8-9c17-09a00e02d35a" class="block-color-gray_background">SELECT country_code,
MIN(invested_companies),
MAX(invested_companies),
AVG(invested_companies)
FROM fund
WHERE EXTRACT(YEAR FROM CAST(founded_at AS date)) BETWEEN 2010 AND 2012
GROUP BY country_code
HAVING  MIN(invested_companies) != 0
ORDER BY AVG(invested_companies) DESC
LIMIT 10;</p><table id="392a0104-7060-477e-81a0-472ef29a2c3d" class="simple-table"><tbody><tr id="9f526347-54b5-48da-97b1-1bb705878386"><td id="s^{N" class="">country_code</td><td id="e{~m" class="">min</td><td id="CcMf" class="">max</td><td id="yd?@" class="">avg</td></tr><tr id="40c9a9e3-df89-4b81-9d03-1e0f3c9a2d1a"><td id="s^{N" class="">BGR</td><td id="e{~m" class="">25</td><td id="CcMf" class="">35</td><td id="yd?@" class="">30</td></tr><tr id="ebddf61e-5cb1-41b5-a081-1fedf9ce1e3a"><td id="s^{N" class="">CHL</td><td id="e{~m" class="">29</td><td id="CcMf" class="">29</td><td id="yd?@" class="">29</td></tr><tr id="1227d41a-d6c5-4cf2-98de-4a5a80e62bcd"><td id="s^{N" class="">UKR</td><td id="e{~m" class="">8</td><td id="CcMf" class="">10</td><td id="yd?@" class="">9</td></tr><tr id="8457b9ac-d290-41fa-984b-ea9c59bc0ef9"><td id="s^{N" class="">…</td><td id="e{~m" class="">…</td><td id="CcMf" class="">…</td><td id="yd?@" class="">…</td></tr></tbody></table><ol type="1" id="5b61a583-65ef-42da-8a27-c86717db1fa2" class="numbered-list" start="11"><li>Отобразите имя и фамилию всех сотрудников стартапов. Добавьте поле с названием учебного заведения, которое окончил сотрудник, если эта информация известна.</li></ol><p id="c7b0471b-742f-4305-b0cf-fe6f3e4a3b1c" class="">
</p><p id="916b4771-41c0-4e82-92f0-f9e9c3be46ed" class="block-color-gray_background">SELECT p.first_name,
p.last_name,
ed.instituition
FROM people as p
LEFT JOIN education as ed ON p.id=ed.person_id</p><table id="2e2a1626-67c8-4419-8126-5a061a6df55a" class="simple-table"><tbody><tr id="c6d97a3f-175d-4158-96d3-4670f6bf87e9"><td id="~;k&lt;" class="">first_name</td><td id="f;Z{" class="">last_name</td><td id="TOkY" class="">instituition</td><td id="TAgt" class=""></td></tr><tr id="0b3338d6-328e-433e-99e4-c7d4cbf3bd20"><td id="~;k&lt;" class="">John</td><td id="f;Z{" class="">Green</td><td id="TOkY" class="">Washington University, St. Louis</td><td id="TAgt" class=""></td></tr><tr id="155ec335-17d0-4c1c-8f90-685d8bea323d"><td id="~;k&lt;" class="">John</td><td id="f;Z{" class="">Green</td><td id="TOkY" class="">Boston University</td><td id="TAgt" class=""></td></tr><tr id="4f2e8993-4da8-484b-8134-2840e17eb36c"><td id="~;k&lt;" class="">David</td><td id="f;Z{" class="">Peters</td><td id="TOkY" class="">Rice University</td><td id="TAgt" class=""></td></tr><tr id="99a79eb5-9b45-48b0-9741-976b176df203"><td id="~;k&lt;" class="">…</td><td id="f;Z{" class="">…</td><td id="TOkY" class="">…</td><td id="TAgt" class=""></td></tr></tbody></table><ol type="1" id="80124139-e3af-4af0-b380-4dc8ee6ab069" class="numbered-list" start="12"><li>Для каждой компании найдите количество учебных заведений, которые окончили её сотрудники. Выведите название компании и число уникальных названий учебных заведений. Составьте топ-5 компаний по количеству университетов.</li></ol><p id="09396b7b-513d-4942-928e-138092845a17" class="">
</p><p id="30445b20-8391-4424-94d2-8a604ad0adc2" class="block-color-gray_background">SELECT DISTINCT <a href="http://c.name/">c.name</a>,
COUNT(DISTINCT (ed.instituition))
FROM company as c
INNER JOIN people as p ON c.id=p.company_id
INNER JOIN education as ed ON p.id=ed.person_id
GROUP BY <a href="http://c.name/">c.name</a>
ORDER BY COUNT(DISTINCT (ed.instituition)) DESC
LIMIT 5</p><table id="606e1019-7b40-480e-afe3-3121d1f6a524" class="simple-table"><tbody><tr id="9b227c31-9a61-4ef4-80b8-9b2f2943bf97"><td id="RIY\" class="">name</td><td id="Vih&gt;" class="">count</td></tr><tr id="e273be25-575f-449a-8648-9883867481f4"><td id="RIY\" class="">Google</td><td id="Vih&gt;" class="">167</td></tr><tr id="2776041f-68e2-4d20-8ee7-2a1e6f34de9e"><td id="RIY\" class="">Yahoo!</td><td id="Vih&gt;" class="">115</td></tr><tr id="49d6a89a-544d-4abc-8bdc-e8ef7cdfa082"><td id="RIY\" class="">Microsoft</td><td id="Vih&gt;" class="">111</td></tr><tr id="ffd3c752-7151-4851-a1e2-400877d904fb"><td id="RIY\" class="">Knight Foundation</td><td id="Vih&gt;" class="">74</td></tr></tbody></table><ol type="1" id="0c0cab8d-cd76-4e8f-bb66-1c0a23f51338" class="numbered-list" start="13"><li>Составьте список с уникальными названиями закрытых компаний, для которых первый раунд финансирования оказался последним.</li></ol><p id="8869e646-5307-4a15-bef2-f8c24a9bec94" class="">
</p><p id="b3fb5868-903c-4c36-b190-45fed8f566a7" class="block-color-gray_background">SELECT DISTINCT(<a href="http://c.name/">c.name</a>)
FROM company as c
INNER JOIN funding_round AS f ON c.id=f.company_id
WHERE c.status = &#x27;closed&#x27; AND (f.is_first_round = 1 AND f.is_last_round = 1)</p><p id="77f4fba1-b0ce-4d62-8115-993d9224dcbd" class="">name</p><hr id="fabf0c83-0fd4-41d0-8898-5e4b56e55b18"/><p id="0ce2fd3f-fbba-44e4-86f9-5a80820f5af5" class="">10BestThings</p><hr id="d4589ec5-c6cd-4825-bf57-95d19716ed98"/><p id="430f272e-ee79-4dcb-8463-bd441b02b267" class="">11i Solutions</p><hr id="d8d943d0-5d23-4a41-9484-83416117fe7d"/><p id="788d3732-aa2f-433c-8688-0188bbe9db1f" class="">169 ST.</p><hr id="5b8cb79d-7cd6-4669-8148-f5331b9d1ea7"/><p id="937cf4f8-3d7f-4ac5-9f34-b7b419b280a4" class="">1bib</p><hr id="e49e7ba5-3cc8-49cc-896e-e9278099b803"/><p id="53ea8a64-6b69-45c0-97da-2c0db5acae3c" class="">
</p><ol type="1" id="a22bd15d-3d03-4e5e-aab0-52f544ffad00" class="numbered-list" start="14"><li>Составьте список уникальных номеров сотрудников, которые работают в компаниях, отобранных в предыдущем задании.</li></ol><p id="e3c3a6f5-a1a0-4395-8887-df3a3d7cd1d4" class="block-color-gray_background">SELECT DISTINCT <a href="http://p.id/">p.id</a>
FROM company as c
INNER JOIN funding_round AS f ON c.id=f.company_id
INNER JOIN people as p ON c.id=p.company_id
WHERE c.status = &#x27;closed&#x27; AND (f.is_first_round = 1 AND f.is_last_round = 1)</p><p id="35cf16da-580c-4a73-9019-e2477db26552" class="">id</p><hr id="f2e007d6-ae65-4ab2-9a5a-8c37eb2184a9"/><p id="7abbc284-00e0-4f09-a1e8-a15a4f03c002" class="">62</p><hr id="4e6422ad-f5ef-4b42-a02b-575fece24bb7"/><p id="3730d9d9-3a7a-4930-a6e6-b8340b2835ec" class="">97</p><hr id="4da43356-14c0-4597-98a6-82381b8beac6"/><p id="4d54c469-478e-4c17-8af1-a15eea6ba12f" class="">98</p><hr id="2a74636a-59cc-42d8-9dfc-7aa0cd8c5574"/><p id="bb16aa5d-a814-4b05-bb71-a653bfbb1f6e" class="">225</p><hr id="6361b2be-b2c1-4434-9aa1-05a717957eb3"/><p id="57a78529-6380-4988-a169-4eb9d68e249d" class="">
</p><ol type="1" id="9002eceb-dc4c-418e-b038-d09e758437c7" class="numbered-list" start="15"><li>Составьте таблицу, куда войдут уникальные пары с номерами сотрудников из предыдущей задачи и учебным заведением, которое окончил сотрудник.</li></ol><p id="cbdb5a06-fde7-432c-b620-49bb63bb9999" class="">
</p><p id="c4faf060-7e51-44df-9ad5-147578ddce55" class="block-color-gray_background">SELECT e.person_id,
e.instituition
FROM education as e
WHERE e.person_id IN (SELECT DISTINCT <a href="http://p.id/">p.id</a>
                                      FROM people as p
                                      WHERE p.company_id IN (SELECT DISTINCT <a href="http://c.id/">c.id</a>
                                                                                FROM company as c
                                                                                INNER JOIN funding_round AS f ON c.id=f.company_id
                                                                                WHERE c.status = &#x27;closed&#x27; AND (f.is_first_round = 1 AND f.is_last_round = 1)))
GROUP BY e.instituition, e.person_id</p><table id="506a24fd-dadd-4123-a028-d1951dbeefc3" class="simple-table"><tbody><tr id="db4e35c9-2d15-4366-ad72-ff975575da7d"><td id=";{ee" class="">person_id</td><td id="zrl~" class="">instituition</td></tr><tr id="967c8e8c-2276-42ba-8f97-31796c2f6ae0"><td id=";{ee" class="">349</td><td id="zrl~" class="">AKI</td></tr><tr id="6992747b-df72-4459-a621-d80f053efa7d"><td id=";{ee" class="">48426</td><td id="zrl~" class="">Arg</td></tr><tr id="43db060d-d7c9-41d7-b0b8-f67733476b3c"><td id=";{ee" class="">349</td><td id="zrl~" class="">ArtEZ Hogeschool voor de Kunsten</td></tr><tr id="8dc94b51-19ca-41dd-8836-80cb1eb17060"><td id=";{ee" class="">…</td><td id="zrl~" class="">…</td></tr></tbody></table><ol type="1" id="8ea18f80-6956-45c0-a82e-1f25ac34fac2" class="numbered-list" start="16"><li>Посчитайте количество учебных заведений для каждого сотрудника из предыдущего задания. При подсчёте учитывайте, что некоторые сотрудники могли окончить одно и то же заведение дважды.</li></ol><p id="d7be6c18-23a7-462c-8aa0-ac844afd6ca0" class="">
</p><p id="9a0336a7-c331-48cf-8577-20980a30931c" class="block-color-gray_background">WITH
a as (SELECT <a href="http://p.id/">p.id</a>
        FROM people as p
        WHERE p.company_id IN (SELECT DISTINCT <a href="http://c.id/">c.id</a>
                                                  FROM company as c
                                                  INNER JOIN funding_round AS f ON c.id=f.company_id
                                                  WHERE c.status = &#x27;closed&#x27; AND (f.is_first_round = 1 AND f.is_last_round = 1)))</p><p id="1edffc7b-bdc0-47b5-a4ce-e6b69453ab26" class="block-color-gray_background">SELECT <a href="http://a.id/">a.id</a>,
COUNT(e.instituition)
FROM education as e
INNER JOIN a ON a.id=e.person_id
GROUP BY <a href="http://a.id/">a.id</a></p><table id="aa2feded-b820-4f80-8d4f-2f341d0811db" class="simple-table"><tbody><tr id="12074787-ce88-48bf-9083-f80ef59e61b4"><td id="bP=A" class="">id</td><td id="T~\K" class="">count</td></tr><tr id="11938bed-a46c-4454-8a82-50437fe30285"><td id="bP=A" class="">349</td><td id="T~\K" class="">3</td></tr><tr id="5b4da6ac-1720-4d1b-84b7-f755829f2e70"><td id="bP=A" class="">699</td><td id="T~\K" class="">1</td></tr><tr id="be8bcfa2-394b-4774-ac5f-b4e1c5a62436"><td id="bP=A" class="">779</td><td id="T~\K" class="">2</td></tr><tr id="3987cb61-db15-45f5-a27b-7c4d4190a8f6"><td id="bP=A" class="">…</td><td id="T~\K" class="">…</td></tr></tbody></table><ol type="1" id="c30f9942-5423-4ca1-8829-639faa2420be" class="numbered-list" start="17"><li>Дополните предыдущий запрос и выведите среднее число учебных заведений (всех, не только уникальных), которые окончили сотрудники разных компаний. Нужно вывести только одну запись, группировка здесь не понадобится.</li></ol><p id="e9909122-5ad3-4fe2-9319-924ee938ab97" class="">
</p><p id="bb0ed329-9cf4-4b75-863d-c34f6092638c" class="block-color-gray_background"> WITH
a as (SELECT person_id,
        COUNT(e.instituition) as count_instituition
        FROM education as e
        WHERE person_id IN (SELECT <a href="http://p.id/">p.id</a>
                                           FROM people as p
                                           WHERE p.company_id IN (SELECT DISTINCT <a href="http://c.id/">c.id</a>
                                           FROM company as c
                                           INNER JOIN funding_round AS f ON c.id=f.company_id
                                           WHERE c.status = &#x27;closed&#x27; AND (f.is_first_round = 1 AND f.is_last_round = 1)))
        GROUP BY person_id)</p><p id="50b9c4ac-512a-495c-b046-2b2ee3f548ee" class="block-color-gray_background">SELECT AVG(count_instituition)
FROM a</p><p id="ff1b8dc1-9d2c-4e87-9722-3085730a1ed7" class="">avg</p><hr id="b07a726d-9296-49f1-9fe8-6562e1ecd47b"/><p id="1d1382a6-c33c-41a4-999b-3ddfaec430df" class="">1.41509</p><hr id="4412793a-da5f-474a-aadf-223f29727145"/><p id="8026c913-2bb3-40b8-8703-65ff9c2e09d7" class="">
</p><ol type="1" id="4301ddf9-3119-40f9-8fe6-ade9e0d7fadb" class="numbered-list" start="18"><li>Напишите похожий запрос: выведите среднее число учебных заведений (всех, не только уникальных), которые окончили сотрудники Facebook*.
*(сервис, запрещённый на территории РФ)</li></ol><p id="54866f14-538b-45fa-ac56-adeb3cf8f82d" class="">
</p><p id="fd635326-3fd8-44d9-a707-e9c77d5b98a1" class="block-color-gray_background">WITH
a as (SELECT COUNT(ed.instituition) count_instituition, person_id
        FROM education as ed
        WHERE person_id IN (SELECT <a href="http://p.id/">p.id</a>
                                           FROM people as p
                                           WHERE p.company_id IN (SELECT DISTINCT <a href="http://c.id/">c.id</a>
                                                                                     FROM company as c
                                                                                     WHERE <a href="http://c.name/">c.name</a> = &#x27;Facebook&#x27;))
                                                                                     GROUP BY person_id)</p><p id="e46fdfca-ddd3-4ac4-ad06-f9d3ffe529a3" class="block-color-gray_background">SELECT AVG(count_instituition)
FROM a</p><p id="f4a3cecb-80b7-4ff7-9471-2fdc3acdb31b" class="">avg</p><hr id="9bfebb18-b34b-45cb-8567-2c2fa414394b"/><p id="5e2e36d0-55d4-4c11-a0dd-455b9e9f6b56" class="">1.51111</p><hr id="8dbd0ead-02e4-4101-8828-48fe7f62049b"/><p id="7b5b252f-d04a-4907-95d3-f74c4b22d7af" class="">
</p><ol type="1" id="fc47e1d7-d06c-43a0-9ddf-a9ec8ce376f1" class="numbered-list" start="19"><li>Составьте таблицу из полей:</li></ol><ul id="1450f632-2faf-4cae-94d3-5d6f8fe16f6d" class="bulleted-list"><li style="list-style-type:disc"><code>name_of_fund</code> — название фонда;</li></ul><ul id="0b159ae3-bf30-4fec-9add-62f712ef1a01" class="bulleted-list"><li style="list-style-type:disc"><code>name_of_company</code> — название компании;</li></ul><ul id="d9101c10-3ff9-48ef-8141-aae2c2ca3ed5" class="bulleted-list"><li style="list-style-type:disc"><code>amount</code> — сумма инвестиций, которую привлекла компания в раунде.</li></ul><p id="35a2c1b3-b35a-4375-8a2f-b9a7d0406198" class="">В таблицу войдут данные о компаниях, в истории которых было больше шести важных этапов, а раунды финансирования проходили с 2012 по 2013 год включительно.</p><p id="4bc52e0c-05dc-4d53-ab28-b38fab116c64" class="block-color-gray_background">SELECT <a href="http://f.name/">f.name</a> name_of_fund,
            <a href="http://c.name/">c.name</a> name_of_company,
            fr.raised_amount amount
FROM investment as i
INNER JOIN company as c ON i.company_id=<a href="http://c.id/">c.id</a>
INNER JOIN fund as f ON i.fund_id=<a href="http://f.id/">f.id</a>
INNER JOIN funding_round as fr ON i.funding_round_id=<a href="http://fr.id/">fr.id</a>
WHERE (EXTRACT(YEAR FROM fr.funded_at) BETWEEN 2012 and 2013)
AND c.milestones &gt; 6</p><table id="f79b684b-34e4-49bb-85c2-77f15eb4098d" class="simple-table"><tbody><tr id="c344b21c-87dc-450a-ac90-fc4c34da8a7a"><td id="s{gx" class="">name_of_fund</td><td id="w`Dj" class="">name_of_company</td><td id="abLS" class="">amount</td></tr><tr id="d9c42674-ed47-4e39-a4f3-6bc72c19e5e7"><td id="s{gx" class="">SAP Ventures</td><td id="w`Dj" class="">OpenX</td><td id="abLS" class="">2.50112e+07</td></tr><tr id="83f66c85-fe27-4144-964d-da41c0464316"><td id="s{gx" class="">Samsung Ventures</td><td id="w`Dj" class="">OpenX</td><td id="abLS" class="">2.50112e+07</td></tr><tr id="f30bbc98-b05c-4ce0-9828-18ba5a929bb1"><td id="s{gx" class="">Index Ventures</td><td id="w`Dj" class="">OpenX</td><td id="abLS" class="">2.50112e+07</td></tr><tr id="5488ec4a-478d-4288-bf3c-07dc03e5b708"><td id="s{gx" class="">…</td><td id="w`Dj" class="">…</td><td id="abLS" class="">…</td></tr></tbody></table><p id="5a0f9998-3c2b-4ec0-abdf-ae0055464ab5" class="">
</p><ol type="1" id="34f9d069-c3cc-40cc-870f-6df344c0851a" class="numbered-list" start="20"><li>Выгрузите таблицу, в которой будут такие поля:</li></ol><ul id="e52c4c91-6c1e-4107-a1fd-8d991c412b8c" class="bulleted-list"><li style="list-style-type:disc">название компании-покупателя;</li></ul><ul id="13d36c79-f5f5-4796-af07-d3f500fcc93f" class="bulleted-list"><li style="list-style-type:disc">сумма сделки;</li></ul><ul id="5adeb8e1-96ef-4aa2-8517-acf3b21663f5" class="bulleted-list"><li style="list-style-type:disc">название компании, которую купили;</li></ul><ul id="78760bb5-11da-4888-bcba-7e36b4b64a1a" class="bulleted-list"><li style="list-style-type:disc">сумма инвестиций, вложенных в купленную компанию;</li></ul><ul id="cf50c921-fed2-4e6c-92f0-33a50dce48e6" class="bulleted-list"><li style="list-style-type:disc">доля, которая отображает, во сколько раз сумма покупки превысила сумму вложенных в компанию инвестиций, округлённая до ближайшего целого числа.</li></ul><p id="07dcfdd9-a172-4516-9d63-957ba1c08f9e" class="">Не учитывайте те сделки, в которых сумма покупки равна нулю. Если сумма инвестиций в компанию равна нулю, исключите такую компанию из таблицы.</p><p id="4af67fcf-db28-4c5a-b334-933a5c2acfde" class="">Отсортируйте таблицу по сумме сделки от большей к меньшей, а затем по названию купленной компании в лексикографическом порядке. Ограничьте таблицу первыми десятью записями.</p><p id="b0d6a892-56d8-43db-9969-c0e056096db0" class="block-color-gray_background">SELECT c_acquiring.name,
             price_amount,
             c_acquired.name,
             c_acquired.funding_total as funding_total,
             ROUND(price_amount / funding_total)
FROM (SELECT acquiring_company_id,
             <a href="http://c.name/">c.name</a>,
             price_amount,
             acquired_company_id
            FROM acquisition as a
            LEFT JOIN company as c ON a.acquiring_company_id=<a href="http://c.id/">c.id</a>) as c_acquiring
LEFT JOIN company as c_acquired ON c_acquiring.acquired_company_id=c_acquired.id
WHERE price_amount != 0 AND  c_acquired.funding_total != 0
ORDER BY price_amount DESC, c_acquired.name
LIMIT 10;</p><table id="e2747068-67dc-412d-9d89-e209a3a1569f" class="simple-table"><tbody><tr id="744fe4fe-5d7d-4d4e-a2fe-0b51e9d8d6ae"><td id="ZXPM" class="">name</td><td id="KBsm" class="">price_amount</td><td id="|EBt" class="">funding_total</td><td id="doS^" class="">round</td></tr><tr id="e3e4d256-68d3-41db-9a85-2b69687d404b"><td id="ZXPM" class="">Skype</td><td id="KBsm" class="">8.5e+09</td><td id="|EBt" class="">7.6805e+07</td><td id="doS^" class="">111</td></tr><tr id="3d5722b2-3c82-409f-b05c-1788131ca4a2"><td id="ZXPM" class="">Varian Semiconductor Equipment Associates</td><td id="KBsm" class="">4.9e+09</td><td id="|EBt" class="">4.8e+06</td><td id="doS^" class="">1021</td></tr><tr id="da0e6e08-bedd-4b54-8e78-2ce523e07622"><td id="ZXPM" class="">Aeluros</td><td id="KBsm" class="">3.7e+09</td><td id="|EBt" class="">7.97e+06</td><td id="doS^" class="">464</td></tr><tr id="f95b998b-4d24-4abb-af1f-c3d364c11218"><td id="ZXPM" class="">…</td><td id="KBsm" class="">…</td><td id="|EBt" class="">…</td><td id="doS^" class="">…</td></tr></tbody></table><ol type="1" id="b991137c-a5e6-4a3d-b14c-14ac479cd60e" class="numbered-list" start="21"><li>Выгрузите таблицу, в которую войдут названия компаний из категории <code>social</code>, получившие финансирование с 2010 по 2013 год включительно. Проверьте, что сумма инвестиций не равна нулю. Выведите также номер месяца, в котором проходил раунд финансирования.</li></ol><p id="487331d9-c2cd-41dd-a7c8-b983aac19650" class="">
</p><p id="879ad3ea-4c6d-4720-8e47-2b6638548761" class="block-color-gray_background">SELECT <a href="http://c.name/">c.name</a>,
EXTRACT(MONTH FROM funded_at)
FROM company as c
INNER JOIN funding_round as fr ON c.id=fr.company_id
WHERE category_code = &#x27;social&#x27;
    AND EXTRACT(YEAR FROM funded_at) BETWEEN 2010 AND 2013
    AND raised_amount != 0</p><table id="bdb1d495-a0c4-4515-a327-3da622511daf" class="simple-table"><tbody><tr id="f5ad605e-ebfe-4e24-a160-82465646516f"><td id="_TjY" class="">name</td><td id="fJTi" class="">date_part</td></tr><tr id="70bd4510-f29a-4c07-b3d1-7ec645e1d216"><td id="_TjY" class="">Klout</td><td id="fJTi" class="">1</td></tr><tr id="65b1160b-e55c-4bf1-8031-094353a74e0f"><td id="_TjY" class="">WorkSimple</td><td id="fJTi" class="">3</td></tr><tr id="e8cf7299-25d9-4752-a205-c9967573ced5"><td id="_TjY" class="">HengZhi</td><td id="fJTi" class="">1</td></tr><tr id="e6c4e37a-4c83-4a5f-a350-0a2839fa1944"><td id="_TjY" class="">…</td><td id="fJTi" class="">…</td></tr></tbody></table><ol type="1" id="0103460c-0275-4357-8d8c-d22798c0b8ab" class="numbered-list" start="22"><li>Отберите данные по месяцам с 2010 по 2013 год, когда проходили инвестиционные раунды. Сгруппируйте данные по номеру месяца и получите таблицу, в которой будут поля:</li></ol><ul id="ec8bbeb8-129b-4c15-9090-81b214a13d15" class="bulleted-list"><li style="list-style-type:disc">номер месяца, в котором проходили раунды;</li></ul><ul id="079c4568-ab74-4cde-b67b-a3e0453c1686" class="bulleted-list"><li style="list-style-type:disc">количество уникальных названий фондов из США, которые инвестировали в этом месяце;</li></ul><ul id="5eecd334-fa13-456a-84a8-720a1b6d6782" class="bulleted-list"><li style="list-style-type:disc">количество компаний, купленных за этот месяц;</li></ul><ul id="52754bf7-50a4-4f38-ba25-a6bffc09a6c8" class="bulleted-list"><li style="list-style-type:disc">общая сумма сделок по покупкам в этом месяце.</li></ul><p id="2006c7f1-d82e-4caf-874a-ad07bb1046bd" class="">
</p><p id="67fb00f3-233b-427a-aac9-5f80df06003e" class="block-color-gray_background">WITH
a as (SELECT EXTRACT(MONTH FROM fr.funded_at) as month,
                     COUNT(DISTINCT <a href="http://f.name/">f.name</a>) unique_name
        FROM funding_round as fr
        INNER JOIN investment as i ON i.funding_round_id=<a href="http://fr.id/">fr.id</a>
        INNER JOIN fund as f ON i.fund_id=<a href="http://f.id/">f.id</a>
        WHERE EXTRACT(YEAR FROM fr.funded_at) BETWEEN 2010 AND 2013
            AND f.country_code = &#x27;USA&#x27;
        GROUP BY EXTRACT(MONTH FROM fr.funded_at)),</p><p id="4fc368d9-9e71-4df7-b3db-9d1ea7e69479" class="block-color-gray_background">b as (SELECT EXTRACT(MONTH FROM acquired_at) as month,
                     COUNT(acquired_company_id) count_acquired,
                     SUM(price_amount) price
         FROM acquisition
         WHERE EXTRACT(YEAR FROM acquired_at) BETWEEN 2010 AND 2013
         GROUP BY EXTRACT(MONTH FROM acquired_at))</p><p id="c47c2815-4e7c-4ca4-b0ac-995372b5cc76" class="block-color-gray_background">SELECT a.month,
a.unique_name,
b.count_acquired,
b.price
FROM a INNER JOIN b ON a.month=b.month</p><table id="deb42622-5b45-424c-92a1-b47205e0fb39" class="simple-table"><tbody><tr id="f44ac346-3c94-4535-a447-9ad4203dee1d"><td id="fSW~" class="">month</td><td id="?`H&lt;" class="">unique_name</td><td id="SHNZ" class="">count_acquired</td><td id="x^XC" class="">price</td></tr><tr id="980e1dc9-3b49-4b97-814d-e8c5a1fac718"><td id="fSW~" class="">1</td><td id="?`H&lt;" class="">815</td><td id="SHNZ" class="">600</td><td id="x^XC" class="">2.71083e+10</td></tr><tr id="821b800f-3042-4b46-bb0b-303157d6dcff"><td id="fSW~" class="">2</td><td id="?`H&lt;" class="">637</td><td id="SHNZ" class="">418</td><td id="x^XC" class="">4.13903e+10</td></tr><tr id="28185e7c-af34-45ac-95a2-09fa362273e6"><td id="fSW~" class="">3</td><td id="?`H&lt;" class="">695</td><td id="SHNZ" class="">458</td><td id="x^XC" class="">5.95016e+10</td></tr><tr id="093c78ea-3e2a-4839-9d0d-7cb614ba0c88"><td id="fSW~" class="">…</td><td id="?`H&lt;" class="">…</td><td id="SHNZ" class="">…</td><td id="x^XC" class="">…</td></tr></tbody></table><ol type="1" id="fffd08f5-e340-4391-aa7f-183ae22867b8" class="numbered-list" start="23"><li>Составьте сводную таблицу и выведите среднюю сумму инвестиций для стран, в которых есть стартапы, зарегистрированные в 2011, 2012 и 2013 годах. Данные за каждый год должны быть в отдельном поле. Отсортируйте таблицу по среднему значению инвестиций за 2011 год от большего к меньшему.</li></ol><p id="b8a5d5c3-33cf-4526-ad0b-0fd1506a6ec5" class="block-color-gray_background">all_2012 as (SELECT country_code,
                                AVG(funding_total) as total_2012
                    FROM company
                    WHERE EXTRACT(YEAR FROM founded_at) = 2012
                    GROUP BY country_code),</p><p id="32324a98-5a91-46d0-9525-0a36cbf268f4" class="block-color-gray_background">all_2013 as (SELECT country_code,
                                AVG(funding_total) as total_2013
                   FROM company
                   WHERE EXTRACT(YEAR FROM founded_at) = 2013
                   GROUP BY country_code)</p><p id="0941c640-f014-4667-b371-334ec46fbb4c" class="block-color-gray_background">SELECT all_2011.country_code,
all_2011.total_2011,
all_2012.total_2012,
all_2013.total_2013
FROM all_2011
INNER JOIN all_2012 ON all_2011.country_code=all_2012.country_code
INNER JOIN all_2013 ON all_2012.country_code=all_2013.country_code
ORDER BY total_2011 DESC;</p><table id="672d4fa4-a4c9-4268-bdf1-338d6d059627" class="simple-table"><tbody><tr id="ddb46d69-8534-41e4-b340-ebe7c2c10bc4"><td id="LPl&lt;" class="">ountry_code</td><td id="hHl\" class="">total_2011</td><td id="k?]F" class="">total_2012</td><td id=":yF@" class="">total_2013</td></tr><tr id="ccd0ebee-1a94-4b68-a467-5f5ce2738410"><td id="LPl&lt;" class="">PER</td><td id="hHl\" class="">4e+06</td><td id="k?]F" class="">41000</td><td id=":yF@" class="">25000</td></tr><tr id="4925bdce-b397-4671-8c1c-a1ab8bb5d9a1"><td id="LPl&lt;" class="">USA</td><td id="hHl\" class="">2.24396e+06</td><td id="k?]F" class="">1.20671e+06</td><td id=":yF@" class="">1.09336e+06</td></tr><tr id="7aac9653-f760-4b44-b060-99ce26da42cd"><td id="LPl&lt;" class="">HKG</td><td id="hHl\" class="">2.18078e+06</td><td id="k?]F" class="">226227</td><td id=":yF@" class="">0</td></tr><tr id="fbb86e87-1f39-4bf9-922b-dd9bd4bfaec4"><td id="LPl&lt;" class="">…</td><td id="hHl\" class="">…</td><td id="k?]F" class="">…</td><td id=":yF@" class="">…</td></tr></tbody></table><p id="dfec842b-b555-4041-a87f-e5520af71ebd" class="">
</p></div></article></body></html>